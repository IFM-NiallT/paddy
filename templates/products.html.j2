<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>PADDY - Products</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css2?family=Liter:wght@400;700&display=swap" rel="stylesheet">
   <style>
       body {
           background-color: #FEE9E9;
           font-family: 'Liter', sans-serif;
           color: #000;
           display: flex;
           flex-direction: column;
           min-height: 100vh;
       }

       main {
           flex: 1;
           display: flex;
           flex-direction: column;
       }

       .navbar {
           background-color: #FEE9E9;
           border-bottom: 3px solid #B20000;
       }

       .navbar-brand {
           font-size: 2rem;
           font-weight: bold;
           color: #B20000;
           text-shadow: 2px 2px 5px #B20000, -2px -2px 5px #FF4040;
       }

       footer {
           background-color: #FE0000;
           color: #FFFFFF;
           padding: 10px;
           text-align: center;
           width: 100%;
           margin-top: auto;
       }

       footer::before {
           content: "";
           display: block;
           height: 3px;
           background-color: #B20000;
           margin-bottom: 10px;
       }

       .quote {
           font-size: 1.2rem;
           font-style: italic;
       }

       .table-container {
           background: #FFFFFF;
           border: 1px solid #B20000;
           padding: 15px;
           border-radius: 10px;
           overflow-x: auto;
           margin: 10px auto;
       }

       .table th {
           background-color: #B20000;
           color: #FFFFFF;
           cursor: pointer;
           position: relative;
           padding-right: 20px !important;
       }

       .table th:hover {
           background-color: #FF4040;
       }

       .table th::after {
           content: '↕';
           position: absolute;
           right: 8px;
           top: 50%;
           transform: translateY(-50%);
           color: #FFFFFF;
       }

       .table th.asc::after {
           content: '↑';
       }

       .table th.desc::after {
           content: '↓';
       }

       .table tbody tr:hover {
           background-color: #FEE9E9;
       }

       .btn-uni {
           background-color: #B20000;
           color: #FFFFFF;
           border: none;
           padding: 10px 20px;
           border-radius: 5px;
           transition: all 0.3s ease;
           cursor: pointer;
       }

       .btn-uni:hover {
           background-color: #FF4040;
       }
   </style>
</head>
<body>
   <nav class="navbar navbar-expand-lg">
       <div class="container">
           <a class="navbar-brand" href="/">PADDY</a>
           <button class="btn-uni" onclick="window.location.href='/'">Back to Categories</button>
       </div>
   </nav>

   <main>
       <div class="container mt-5">
           <div class="table-container">
               <h4 class="text-center">{{ category.Description }} ({{ category.Code }})</h4>
               <table class="table table-bordered" id="productsTable">
                   <thead>
                       <tr>
                           <th onclick="sortTable(0)">ID</th>
                           <th onclick="sortTable(1)">Product Name</th>
                           <th onclick="sortTable(2)">Code</th>
                           <th onclick="sortTable(3)">Updated On</th>
                           <th onclick="sortTable(4)">Price</th>
                           <th onclick="sortTable(5)">Classification</th>
                           <th onclick="sortTable(6)">Thread Gender</th>
                           <th onclick="sortTable(7)">Size A</th>
                           <th onclick="sortTable(8)">Size B</th>
                           <th onclick="sortTable(9)">Size C</th>
                           <th onclick="sortTable(10)">Size D</th>
                           <th onclick="sortTable(11)">Orientation</th>
                           <th onclick="sortTable(12)">Configuration</th>
                           <th onclick="sortTable(13)">Grade</th>
                           <th onclick="sortTable(14)">Manufacturer</th>
                           <th onclick="sortTable(15)">Application</th>
                           <th onclick="sortTable(16)">Web Category</th>
                       </tr>
                   </thead>
                   <tbody>
                       {% for product in products.Data %}
                           <tr>
                               <td>{{ product.ID }}</td>
                               <td>{{ product.Description }}</td>
                               <td>{{ product.Code }}</td>
                               <td>{{ product.UpdatedOn.split('T')[0] }}</td>
                               <td>{{ product.Price if product.Price else 'N/A' }}</td>
                               <td>{{ product.D_Classification if product.D_Classification else 'N/A' }}</td>
                               <td>{{ product.D_ThreadGender if product.D_ThreadGender else 'N/A' }}</td>
                               <td>{{ product.D_SizeA if product.D_SizeA else 'N/A' }}</td>
                               <td>{{ product.D_SizeB if product.D_SizeB else 'N/A' }}</td>
                               <td>{{ product.D_SizeC if product.D_SizeC else 'N/A' }}</td>
                               <td>{{ product.D_SizeD if product.D_SizeD else 'N/A' }}</td>
                               <td>{{ product.D_Orientation if product.D_Orientation else 'N/A' }}</td>
                               <td>{{ product.D_Configuration if product.D_Configuration else 'N/A' }}</td>
                               <td>{{ product.D_Grade if product.D_Grade else 'N/A' }}</td>
                               <td>{{ product.D_ManufacturerName if product.D_ManufacturerName else 'N/A' }}</td>
                               <td>{{ product.D_Application if product.D_Application else 'N/A' }}</td>
                               <td>{{ product.D_WebCategory if product.D_WebCategory else 'N/A' }}</td>
                           </tr>
                       {% endfor %}
                   </tbody>
               </table>
           </div>
       </div>
   </main>

   <footer>
       <p>PADDY &copy; 2025 - IFM</p>
       <p class="quote">"Product Attribute Designer Deployment (for) You"</p>
   </footer>

   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
   
   <script>
       function sortTable(n) {
           var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
           table = document.getElementById("productsTable");
           switching = true;
           dir = "asc";
           
           // Remove existing sort indicators
           var headers = table.getElementsByTagName("th");
           for (i = 0; i < headers.length; i++) {
               headers[i].classList.remove('asc', 'desc');
           }

           while (switching) {
               switching = false;
               rows = table.rows;
               
               for (i = 1; i < (rows.length - 1); i++) {
                   shouldSwitch = false;
                   x = rows[i].getElementsByTagName("td")[n];
                   y = rows[i + 1].getElementsByTagName("td")[n];

                   // Get the values to compare
                   let xValue = x.innerHTML.trim();
                   let yValue = y.innerHTML.trim();

                   // Handle 'N/A' values
                   if (xValue === 'N/A') xValue = '';
                   if (yValue === 'N/A') yValue = '';

                   // Special handling for dates (column 3 is Updated On)
                   if (n === 3) {
                       xValue = new Date(xValue);
                       yValue = new Date(yValue);
                   }
                   // Special handling for numeric values (ID and Price)
                   else if (n === 0 || n === 4) {
                       xValue = xValue === '' ? -Infinity : parseFloat(xValue);
                       yValue = yValue === '' ? -Infinity : parseFloat(yValue);
                   }
                   // For text values, convert to lowercase for comparison
                   else {
                       xValue = xValue.toLowerCase();
                       yValue = yValue.toLowerCase();
                   }

                   if (dir === "asc") {
                       if (xValue > yValue) {
                           shouldSwitch = true;
                           break;
                       }
                   } else if (dir === "desc") {
                       if (xValue < yValue) {
                           shouldSwitch = true;
                           break;
                       }
                   }
               }
               
               if (shouldSwitch) {
                   rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                   switching = true;
                   switchcount++;
               } else {
                   if (switchcount === 0 && dir === "asc") {
                       dir = "desc";
                       switching = true;
                   }
               }
           }

           // Add sort indicator to the clicked header
           headers[n].classList.add(dir);
       }
   </script>
</body>
</html>