<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>PADDY - Products</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css2?family=Liter:wght@400;700&display=swap" rel="stylesheet">
   <style>
       /* Base styles */
body {
    background-color: #FEE9E9;
    font-family: 'Liter', sans-serif;
    color: #000;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

main {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.container {
    max-width: 95% !important;
    width: 95%;
    margin: 0 auto;
}

/* Navbar styles */
.navbar {
    background-color: #FEE9E9;
    border-bottom: 3px solid #B20000;
}

.navbar-brand {
    font-size: 2rem;
    font-weight: bold;
    color: #B20000;
    text-shadow: 2px 2px 5px #B20000, -2px -2px 5px #FF4040;
}

/* Footer styles */
footer {
    background-color: #FE0000;
    color: #FFFFFF;
    padding: 10px;
    text-align: center;
    width: 100%;
    margin-top: auto;
}

footer::before {
    content: "";
    display: block;
    height: 3px;
    background-color: #B20000;
    margin-bottom: 10px;
}

.quote {
    font-size: 1.2rem;
    font-style: italic;
}

/* Table container styles */
.table-container {
    background: #FFFFFF;
    border: 1px solid #B20000;
    padding: 20px;
    border-radius: 10px;
    margin: 10px auto;
    width: 100%;
    box-sizing: border-box;
    overflow: auto;
    max-width: 100%;
}

/* Table responsive wrapper */
.table-responsive {
    overflow-x: auto;
    margin: 0;
    padding: 0;
    width: 100%;
}

/* Table styles */
.table {
    width: 100%;
    margin-bottom: 0;
    font-size: 0.85rem;
    table-layout: fixed;
}

/* Table header styles */
.table th {
    background-color: #B20000;
    color: #FFFFFF;
    cursor: pointer;
    position: sticky;
    top: 0;
    z-index: 1;
    padding: 8px !important;
    font-size: 0.85rem;
    white-space: normal;
    vertical-align: middle;
    width: 100px;
}

/* Specific column widths */
.table th:nth-child(1), 
.table td:nth-child(1) {
    width: 60px;
}

.table th:nth-child(2), 
.table td:nth-child(2) {
    width: 180px;
}

.table th:nth-child(3), 
.table td:nth-child(3) {
    width: 80px;
}

.table th:nth-child(4), 
.table td:nth-child(4) {
    width: 90px;
}

.table th:nth-child(5), 
.table td:nth-child(5) {
    width: 70px;
}

/* Table cell styles */
.table td {
    padding: 8px !important;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: middle;
}

/* Sort indicator styles */
.table th:hover {
    background-color: #FF4040;
}

.table th::after {
    content: '↕';
    position: absolute;
    right: 4px;
    color: #FFFFFF;
}

.table th.asc::after {
    content: '↑';
}

.table th.desc::after {
    content: '↓';
}

/* Row hover effect */
.table tbody tr:hover {
    background-color: #FEE9E9;
}

/* Tooltip styles */
.table td[data-full-text] {
    position: relative;
}

.table td[data-full-text]:hover::after {
    content: attr(data-full-text);
    position: absolute;
    left: 0;
    top: 100%;
    background: #FFF;
    border: 1px solid #B20000;
    padding: 5px;
    z-index: 2;
    white-space: normal;
    max-width: 200px;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* Button styles */
.btn-uni {
    background-color: #B20000;
    color: #FFFFFF;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.btn-uni:hover {
    background-color: #FF4040;
}

/* Search styles */
/* Update the search container styles */
.search-container {
    margin: 20px auto;
    max-width: 600px;
    display: flex;
    gap: 10px;
}

.search-input {
    flex: 1;
    padding: 12px 20px;
    border: 2px solid #B20000;
    border-radius: 5px;
    font-size: 1.1rem;
    background-color: white;
    transition: all 0.3s ease;
}

.search-input:focus {
    outline: none;
    box-shadow: 0 0 5px #B20000;
}

.search-button {
    background-color: #B20000;
    color: #FFFFFF;
    border: none;
    padding: 12px 25px;
    border-radius: 5px;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.search-button:hover {
    background-color: #FF4040;
}
   </style>
</head>
<body>
   <nav class="navbar navbar-expand-lg">
       <div class="container">
           <a class="navbar-brand" href="/">PADDY</a>
           <button class="btn-uni" onclick="window.location.href='/'">Back to Categories</button>
       </div>
   </nav>

   <div class="container">
       <div class="search-container">
           <input type="text" 
                  class="search-input" 
                  id="productSearch" 
                  placeholder="Search products...">
           <button class="search-button" onclick="searchProducts()">Search</button>
       </div>
   </div>

   <main>
       <div class="table-container">
            <h4 class="text-center">{{ category.Description }} ({{ category.Code }})</h4>
            <div class="table-responsive">
                <table class="table table-bordered" id="productsTable">
                   <thead>
                       <tr>
                           <th onclick="sortTable(0)">ID</th>
                           <th onclick="sortTable(1)">Product Name</th>
                           <th onclick="sortTable(2)">Code</th>
                           <th onclick="sortTable(3)">Updated On</th>
                           <th onclick="sortTable(4)">Price</th>
                           <th onclick="sortTable(5)">Classification</th>
                           <th onclick="sortTable(6)">Thread Gender</th>
                           <th onclick="sortTable(7)">Size A</th>
                           <th onclick="sortTable(8)">Size B</th>
                           <th onclick="sortTable(9)">Size C</th>
                           <th onclick="sortTable(10)">Size D</th>
                           <th onclick="sortTable(11)">Orientation</th>
                           <th onclick="sortTable(12)">Configuration</th>
                           <th onclick="sortTable(13)">Grade</th>
                           <th onclick="sortTable(14)">Manufacturer</th>
                           <th onclick="sortTable(15)">Application</th>
                           <th onclick="sortTable(16)">Web Category</th>
                       </tr>
                   </thead>
                   <tbody>
                       {% for product in products.Data %}
                           <tr class="product-row">
                               <td>{{ product.ID }}</td>
                               <td data-full-text="{{ product.Description }}">{{ product.Description }}</td>
                               <td>{{ product.Code }}</td>
                               <td>{{ product.UpdatedOn.split('T')[0] }}</td>
                               <td>{{ product.Price if product.Price else 'N/A' }}</td>
                               <td data-full-text="{{ product.D_Classification if product.D_Classification else 'N/A' }}">
                                   {{ product.D_Classification if product.D_Classification else 'N/A' }}
                               </td>
                               <td>{{ product.D_ThreadGender if product.D_ThreadGender else 'N/A' }}</td>
                               <td>{{ product.D_SizeA if product.D_SizeA else 'N/A' }}</td>
                               <td>{{ product.D_SizeB if product.D_SizeB else 'N/A' }}</td>
                               <td>{{ product.D_SizeC if product.D_SizeC else 'N/A' }}</td>
                               <td>{{ product.D_SizeD if product.D_SizeD else 'N/A' }}</td>
                               <td data-full-text="{{ product.D_Orientation if product.D_Orientation else 'N/A' }}">
                                   {{ product.D_Orientation if product.D_Orientation else 'N/A' }}
                               </td>
                               <td data-full-text="{{ product.D_Configuration if product.D_Configuration else 'N/A' }}">
                                   {{ product.D_Configuration if product.D_Configuration else 'N/A' }}
                               </td>
                               <td>{{ product.D_Grade if product.D_Grade else 'N/A' }}</td>
                               <td data-full-text="{{ product.D_ManufacturerName if product.D_ManufacturerName else 'N/A' }}">
                                   {{ product.D_ManufacturerName if product.D_ManufacturerName else 'N/A' }}
                               </td>
                               <td data-full-text="{{ product.D_Application if product.D_Application else 'N/A' }}">
                                   {{ product.D_Application if product.D_Application else 'N/A' }}
                               </td>
                               <td data-full-text="{{ product.D_WebCategory if product.D_WebCategory else 'N/A' }}">
                                   {{ product.D_WebCategory if product.D_WebCategory else 'N/A' }}
                               </td>
                           </tr>
                       {% endfor %}
                   </tbody>
               </table>
           </div>
       </div>
   </main>

   <footer>
       <p>PADDY &copy; 2025 - IFM</p>
       <p class="quote">"Product Attribute Designer Deployment (for) You"</p>
   </footer>

   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
   
   <script>
       function sortTable(n) {
           var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
           table = document.getElementById("productsTable");
           switching = true;
           dir = "asc";
           
           var headers = table.getElementsByTagName("th");
           for (i = 0; i < headers.length; i++) {
               headers[i].classList.remove('asc', 'desc');
           }

           while (switching) {
               switching = false;
               rows = table.rows;
               
               for (i = 1; i < (rows.length - 1); i++) {
                   shouldSwitch = false;
                   x = rows[i].getElementsByTagName("td")[n];
                   y = rows[i + 1].getElementsByTagName("td")[n];

                   let xValue = x.innerHTML.trim();
                   let yValue = y.innerHTML.trim();

                   if (xValue === 'N/A') xValue = '';
                   if (yValue === 'N/A') yValue = '';

                   if (n === 3) {
                       xValue = new Date(xValue);
                       yValue = new Date(yValue);
                   }
                   else if (n === 0 || n === 4) {
                       xValue = xValue === '' ? -Infinity : parseFloat(xValue);
                       yValue = yValue === '' ? -Infinity : parseFloat(yValue);
                   }
                   else {
                       xValue = xValue.toLowerCase();
                       yValue = yValue.toLowerCase();
                   }

                   if (dir === "asc") {
                       if (xValue > yValue) {
                           shouldSwitch = true;
                           break;
                       }
                   } else if (dir === "desc") {
                       if (xValue < yValue) {
                           shouldSwitch = true;
                           break;
                       }
                   }
               }
               
               if (shouldSwitch) {
                   rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                   switching = true;
                   switchcount++;
               } else {
                   if (switchcount === 0 && dir === "asc") {
                       dir = "desc";
                       switching = true;
                   }
               }
           }

           headers[n].classList.add(dir);
       }

       function searchProducts() {
           const searchInput = document.getElementById('productSearch');
           const filter = searchInput.value.toLowerCase();
           const rows = document.getElementsByClassName('product-row');

           for (let row of rows) {
               const cells = row.getElementsByTagName('td');
               let found = false;

               for (let cell of cells) {
                   const text = cell.textContent || cell.innerText;
                   if (text.toLowerCase().indexOf(filter) > -1) {
                       found = true;
                       break;
                   }
               }

               if (found) {
                   row.style.display = "";
               } else {
                   row.style.display = "none";
               }
           }
       }

       document.getElementById('productSearch').addEventListener('input', function(e) {
           searchProducts();
       });

       // Add event listener for Enter key
       document.getElementById('productSearch').addEventListener('keypress', function(e) {
           if (e.key === 'Enter') {
               searchProducts();
           }
       });
   </script>
</body>
</html>